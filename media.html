<!-- Pantalla para enviar mensaje -->
        <div data-role="page" id="media" data-dom-cache="true">
            <div data-role="header" data-position="fixed" data-theme="d">
                <a href="#reporte" data-icon="arrow-l" data-direction="reverse" data-transition="none">Atrás</a>
                <h1>Media</h1>
            </div>
            <div data-role="content">
                    <label for="texto">Mensaje:</label>
                    <textarea name="texto" id="texto" rows="5" placeholder="Introduce una descripción breve del problema."></textarea>
                    <div data-role="fieldcontain" class="ui-hide-label">
                        <button data-role="button" data-theme="b" id="btn_enviar_texto">Enviar texto</button>
                    </div>
                <p>Complementa tu reporte con fotografías y/o audio:</p>
                <div class="ui-grid-a">
                    <div class="ui-block-a"><a href="#" onclick="Photo();" data-role="button" data-icon="plus" data-iconpos="top">Foto</a></div>
                    <div class="ui-block-b"><a href="#" onclick="Audio();" data-role="button" data-icon="plus" data-iconpos="top">Audio</a></div>
                </div>
            </div>
            <script>
                var urlReporte = window.localStorage.getItem('ws_host')+window.localStorage.getItem('ws_ruta')+"add_reporte";
                
                $('#media').on('pageinit', function(event){
                    $('#btn_enviar_texto').click(function(){
                        var texto = $('#texto').val();
                        
                        $.mobile.loading( 'show', {
                                text: 'Enviando descripción.',
                                textVisible: true,
                                theme: 'z',
                                html: ""
                        });
                        
                        console.log('Texto:'+ texto);
                        console.log('Evento:'+ idEvento);
                        console.log('Latitud:'+ latitud);
                        console.log('Longitud:'+ longitud);
                        console.log('Ruta: '+urlMedia);
                        $.ajax({
                            url: urlReporte,
                            dataType: "json",
                            crossDomain: "true",
                            data: { id_persona: idPersona, 
                                id_evento: idEvento, 
                                mensaje: texto, 
                                latitud: latitud,
                                longitud: longitud}
                        }).done(function( respuesta ) {
                            $.mobile.loading('hide');
                            if( respuesta.mensaje === 'ok' ){
                                alert("Mensaje enviado correctamente");
                                //window.localStorage.setItem("id_evento", respuesta.id_evento);
                                //window.localStorage.setItem("telefono", respuesta.telefono);
                                //$.mobile.changePage('#media', {transition: 'slide'});
                            }else if( respuesta.validacion === 'error' ){
                                alert( respuesta.mensaje );
                            }
                        }).fail(function (){
                            alert("Error al intentar conectar con el servidor.");
                            //$('#formulario input, #formulario button').removeAttr('disabled'); //deshabilita el formulario
                            //$('#ingresar i').removeClass().addClass('icon-signin'); //le agrega una animación al botón (loader)
                        });
                        $('#texto').val('');
                    });
                });
            </script>
        </div>